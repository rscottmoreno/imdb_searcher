<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>IMDb Search Launcher</title>
    <style>
      :root {
        --bg: #0a1124;
        --bg-soft: #111b35;
        --panel: #142247;
        --panel-soft: #1a2d5d;
        --text: #eaf1ff;
        --muted: #a5b8df;
        --primary: #7a9fff;
        --primary-2: #6a8ff7;
        --accent: #ffd978;
        --border: #2a3f74;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: "Inter", "Segoe UI", Arial, sans-serif;
        color: var(--text);
        background:
          radial-gradient(circle at 20% 0%, rgba(122, 159, 255, 0.2), transparent 35%),
          radial-gradient(circle at 95% 10%, rgba(255, 217, 120, 0.12), transparent 28%),
          linear-gradient(180deg, var(--bg-soft), var(--bg));
      }

      .page {
        width: min(760px, 94%);
        margin: 0 auto;
        padding: 1rem 0 2rem;
      }

      .hero {
        border: 1px solid var(--border);
        border-radius: 18px;
        background: linear-gradient(140deg, #1a2f66, #1e3c7b 54%, #264b97);
        padding: 1rem;
      }

      .hero h1 {
        margin: 0;
        font-size: clamp(1.4rem, 6vw, 2.1rem);
        letter-spacing: -0.02em;
      }

      .hero h1 span {
        color: var(--accent);
      }

      .hero p {
        margin: 0.5rem 0 0;
        color: #d7e2ff;
        line-height: 1.5;
        font-size: 0.95rem;
      }

      .panel {
        margin-top: 0.9rem;
        border: 1px solid var(--border);
        border-radius: 18px;
        background: var(--panel);
        padding: 1rem;
      }

      .field {
        margin-bottom: 0.95rem;
      }

      .field label {
        display: block;
        color: var(--muted);
        font-size: 0.9rem;
        font-weight: 700;
        margin-bottom: 0.45rem;
      }

      input[type="text"],
      input[type="number"] {
        width: 100%;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: var(--panel-soft);
        color: var(--text);
        font-size: 1rem;
        padding: 0.78rem 0.85rem;
      }

      .chips {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .chip {
        border: 1px solid var(--border);
        border-radius: 999px;
        background: #1d2f5f;
        color: var(--muted);
        padding: 0.5rem 0.8rem;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
      }

      .chip.active {
        border-color: #8eafff;
        background: #2b4688;
        color: #e6eeff;
      }

      .toggle-row {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--muted);
        font-size: 0.92rem;
        margin-bottom: 0.4rem;
      }

      .actions {
        display: grid;
        gap: 0.65rem;
      }

      button {
        width: 100%;
        border-radius: 14px;
        padding: 0.88rem 1rem;
        font-size: 1rem;
        font-weight: 800;
        border: 1px solid transparent;
        cursor: pointer;
        touch-action: manipulation;
      }

      .btn-primary {
        background: linear-gradient(180deg, var(--primary), var(--primary-2));
        color: #fff;
      }

      .btn-secondary {
        background: #223766;
        color: #d7e3ff;
        border-color: #35508e;
      }

      .btn-ai {
        background: linear-gradient(180deg, #2f7c6a, #266757);
        color: #ecfff8;
      }

      .url-preview {
        margin-top: 0.8rem;
        padding: 0.75rem;
        border: 1px dashed #375593;
        border-radius: 12px;
        color: var(--muted);
        word-break: break-all;
        font-size: 0.82rem;
      }

      .hint {
        color: var(--muted);
        font-size: 0.82rem;
        margin-top: 0.3rem;
      }

      .ai-note {
        margin-top: 0.8rem;
        padding: 0.7rem;
        border: 1px dashed #3d7f70;
        border-radius: 12px;
        color: #bdeedd;
        font-size: 0.82rem;
        line-height: 1.35;
      }
    </style>
  </head>
  <body>
    <main class="page">
      <section class="hero">
        <h1><span>IMDb</span> Search Launcher</h1>
        <p>Pick filters, then jump straight into IMDb Advanced Search with one tap.</p>
      </section>

      <section class="panel">
        <div class="field">
          <label for="aiPrompt">Search</label>
          <input id="aiPrompt" type="text" placeholder="e.g. scary movie in the woods" />
          <p class="hint">Optional natural language prompt</p>
        </div>

        <div class="field">
          <label>Genre Picker</label>
          <div class="chips" id="genreChips"></div>
        </div>

        <div class="field">
          <label for="oldestYear">Oldest Year</label>
          <input id="oldestYear" type="number" min="1900" max="2100" value="2000" />
        </div>

        <div class="field">
          <label for="minRating">Minimum Rating</label>
          <input id="minRating" type="number" min="0" max="10" step="0.1" placeholder="e.g. 7.5" />
          <p class="hint">Optional</p>
        </div>

        <div class="field">
          <label for="titleSearch">Title Keyword</label>
          <input id="titleSearch" type="text" placeholder="e.g. matrix, king, batman" />
          <p class="hint">Optional</p>
        </div>

        <div class="field">
          <div class="toggle-row">
            <input id="useMinVotes" type="checkbox" checked />
            <label for="useMinVotes">Use minimum votes</label>
          </div>
          <input id="minVotes" type="number" min="0" step="1000" value="50000" />
          <p class="hint">Optional</p>
        </div>

        <div class="actions">
          <button id="openImdbButton" class="btn-primary" type="button">Search on IMDb</button>
          <button id="aiSearchButton" class="btn-ai" type="button">AI Search on IMDb</button>
          <button id="resetButton" class="btn-secondary" type="button">Reset Filters</button>
        </div>

        <div id="urlPreview" class="url-preview"></div>
        <div id="aiNote" class="ai-note">AI helper ready. Add a prompt to guide the search.</div>
      </section>
    </main>

    <script>
      const genres = [
        "Action",
        "Adventure",
        "Animation",
        "Biography",
        "Comedy",
        "Crime",
        "Documentary",
        "Drama",
        "Family",
        "Fantasy",
        "Horror",
        "Mystery",
        "Romance",
        "Sci-Fi",
        "Thriller"
      ];

      const chipsEl = document.getElementById("genreChips");
      const oldestYearEl = document.getElementById("oldestYear");
      const minRatingEl = document.getElementById("minRating");
      const aiPromptEl = document.getElementById("aiPrompt");
      const titleSearchEl = document.getElementById("titleSearch");
      const useMinVotesEl = document.getElementById("useMinVotes");
      const minVotesEl = document.getElementById("minVotes");
      const openImdbButtonEl = document.getElementById("openImdbButton");
      const aiSearchButtonEl = document.getElementById("aiSearchButton");
      const resetButtonEl = document.getElementById("resetButton");
      const urlPreviewEl = document.getElementById("urlPreview");
      const aiNoteEl = document.getElementById("aiNote");

      const selectedGenres = new Set();

      function toImdbGenreName(genreName) {
        const map = { "Sci-Fi": "sci_fi" };
        return map[genreName] || genreName.toLowerCase().replace(/\s+/g, "_");
      }

      function parseAiPrompt(prompt) {
        const text = (prompt || "").trim().toLowerCase();
        if (!text) {
          return { genres: [], keywords: [], titleHint: "" };
        }

        const genreSignals = [
          { terms: ["scary", "horror", "haunted", "ghost", "demon", "slasher"], genre: "Horror" },
          { terms: ["funny", "comedy", "laugh"], genre: "Comedy" },
          { terms: ["space", "alien", "future", "robot", "sci-fi", "science fiction"], genre: "Sci-Fi" },
          { terms: ["romantic", "love", "romance"], genre: "Romance" },
          { terms: ["crime", "mafia", "gangster", "heist"], genre: "Crime" },
          { terms: ["mystery", "detective", "whodunit"], genre: "Mystery" },
          { terms: ["thriller", "suspense"], genre: "Thriller" },
          { terms: ["war", "army", "battle"], genre: "Action" },
          { terms: ["family", "kids"], genre: "Family" },
          { terms: ["dragon", "magic", "wizard"], genre: "Fantasy" },
          { terms: ["real story", "true story", "biopic"], genre: "Biography" }
        ];

        const keywordSignals = [
          { terms: ["woods", "forest", "cabin"], keyword: "forest" },
          { terms: ["zombie", "undead"], keyword: "zombie" },
          { terms: ["shark", "ocean", "sea"], keyword: "ocean" },
          { terms: ["school", "college"], keyword: "school" },
          { terms: ["serial killer", "killer"], keyword: "serial-killer" },
          { terms: ["found footage"], keyword: "found-footage" }
        ];

        const detectedGenres = new Set();
        const detectedKeywords = new Set();

        genreSignals.forEach((entry) => {
          if (entry.terms.some((term) => text.includes(term))) {
            detectedGenres.add(entry.genre);
          }
        });
        keywordSignals.forEach((entry) => {
          if (entry.terms.some((term) => text.includes(term))) {
            detectedKeywords.add(entry.keyword);
          }
        });

        const tokens = text
          .replace(/[^a-z0-9\s]/g, " ")
          .split(/\s+/)
          .filter(Boolean)
          .filter((word) => !["movie", "film", "about", "with", "that", "from", "after", "before", "the", "and"].includes(word))
          .slice(0, 5);

        return {
          genres: [...detectedGenres],
          keywords: [...detectedKeywords],
          titleHint: tokens.join(" ")
        };
      }

      function buildImdbUrl(options = {}) {
        const { aiPrompt = "" } = options;
        const aiData = parseAiPrompt(aiPrompt);
        const params = new URLSearchParams({
          title_type: "feature",
          languages: "en",
          sort: "user_rating,desc"
        });

        const oldestYear = oldestYearEl.value.trim();
        const minRating = minRatingEl.value.trim();
        const titleQuery = titleSearchEl.value.trim() || aiData.titleHint;
        const minVotes = minVotesEl.value.trim();

        if (oldestYear) {
          params.set("release_date", `${oldestYear}-01-01,`);
        }
        if (minRating) {
          params.set("user_rating", `${minRating},`);
        }
        if (titleQuery) {
          params.set("title", titleQuery);
        }
        if (useMinVotesEl.checked && minVotes) {
          params.set("num_votes", `${minVotes},`);
        }
        const allGenres = new Set([...selectedGenres, ...aiData.genres]);
        if (allGenres.size) {
          params.set("genres", [...allGenres].map(toImdbGenreName).join(","));
        }
        if (aiData.keywords.length) {
          params.set("keywords", aiData.keywords.join(","));
        }

        return `https://www.imdb.com/search/title/?${params.toString()}`;
      }

      function updatePreview() {
        urlPreviewEl.textContent = buildImdbUrl({ aiPrompt: aiPromptEl.value.trim() });
      }

      function runAiSearch() {
        const prompt = aiPromptEl.value.trim();
        const aiData = parseAiPrompt(prompt);
        const aiUrl = buildImdbUrl({ aiPrompt: prompt });
        const aiSummary = [];
        if (aiData.genres.length) aiSummary.push(`genres: ${aiData.genres.join(", ")}`);
        if (aiData.keywords.length) aiSummary.push(`keywords: ${aiData.keywords.join(", ")}`);
        if (aiData.titleHint) aiSummary.push(`title hint: "${aiData.titleHint}"`);
        aiNoteEl.textContent = aiSummary.length
          ? `AI interpreted your prompt using ${aiSummary.join(" | ")}`
          : "AI could not infer extra hints, so it used your direct filters only.";
        window.open(aiUrl, "_blank", "noopener,noreferrer");
      }

      function renderGenreChips() {
        chipsEl.innerHTML = "";
        genres.forEach((genre) => {
          const chip = document.createElement("button");
          chip.type = "button";
          chip.className = "chip";
          chip.textContent = genre;
          chip.addEventListener("click", () => {
            if (selectedGenres.has(genre)) {
              selectedGenres.delete(genre);
              chip.classList.remove("active");
            } else {
              selectedGenres.add(genre);
              chip.classList.add("active");
            }
            updatePreview();
          });
          chipsEl.appendChild(chip);
        });
      }

      function resetFilters() {
        selectedGenres.clear();
        oldestYearEl.value = "2000";
        minRatingEl.value = "";
        aiPromptEl.value = "";
        titleSearchEl.value = "";
        useMinVotesEl.checked = true;
        minVotesEl.value = "50000";
        renderGenreChips();
        aiNoteEl.textContent = "AI helper ready. Add a prompt to guide the search.";
        updatePreview();
      }

      openImdbButtonEl.addEventListener("click", () => {
        window.open(buildImdbUrl(), "_blank", "noopener,noreferrer");
      });
      aiSearchButtonEl.addEventListener("click", runAiSearch);

      resetButtonEl.addEventListener("click", resetFilters);
      oldestYearEl.addEventListener("input", updatePreview);
      minRatingEl.addEventListener("input", updatePreview);
      aiPromptEl.addEventListener("input", updatePreview);
      titleSearchEl.addEventListener("input", updatePreview);
      minVotesEl.addEventListener("input", updatePreview);
      useMinVotesEl.addEventListener("change", updatePreview);

      renderGenreChips();
      updatePreview();
    </script>
  </body>
</html>
